services:
  hamdashboard:
    build: .
    container_name: hamdashboard
    ports:
      - "8091:80"
    restart: unless-stopped
    volumes:
      # Optional: Mount config.js for easy configuration changes without rebuilding
      - ./config.js:/usr/share/nginx/html/config.js:ro
    environment:
      - TZ=UTC
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://127.0.0.1/"]
      interval: 30s
      timeout: 3s
      retries: 3
    # Traefik labels for automatic configuration
    labels:
      - "traefik.enable=true"
      # Tell Traefik which network to use
      - "traefik.docker.network=traefik-network"
      # HTTP router
      - "traefik.http.routers.hamdashboard.rule=Host(`hamdash.localhost`)"
      - "traefik.http.routers.hamdashboard.entrypoints=web"
      - "traefik.http.services.hamdashboard.loadbalancer.server.port=80"
    # DNS configuration for Pi-hole
    dns:
      - ${PIHOLE_DNS:-172.19.0.53}  # Pi-hole DNS
      - 1.1.1.1      # Fallback DNS (Cloudflare)
    hostname: hamdash
    # Network configuration
    networks:
      - traefik

networks:
  traefik:
    external: true
    name: traefik-network
  default:
    driver: bridge

